#!/usr/bin/env python

from process import Process
from registry import handle_registry


class Parser:
    def __init__(self):
        self.processes = {}

    def add_process(self, pid=None, ppid=None):
        self.processes[pid] = Process(pid, ppid)

    #Prints out the list of processes being monitored
    def print_process(self):
        for pid in self.processes:
            elem = self.processes[pid]
            print "PID: " + str(elem.pid)
            print "\tParent: " + str(elem.ppid)
            print "\tChildren: " + ','.join(elem.children)
            
            if elem.source_image is not None:
                print "\tSource Image: " + elem.source_image
            else:
                print "\tSource Image: Unknown"
            print "\tRegistries: " + ','.join(elem.regs)
            print "\tFiles Created: " + ','.join(elem.created_files)
            print "\tFiles Read: " + ','.join(elem.read_files)
            print "\tFiles Modified: " + ','.join(elem.written_files)
            print "\tTerminated: " + str(elem.terminated)
